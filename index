<!Doctype html>
<html>




<!--العنوان الرئيسى للصفحة-->
<Head>
    <Title id="water quality monitoring">Water Quality Monitoring</Title>
</Head>
<link rel="stylesheet" href="Water_ Quality.css">


<!-- المستخدم وعنوان الصفحة-->
<div class="username">
    <label for="username" class="dislabel" type="label">Email</label>
    <input id="username" value="" disabled> 
   
</div>
<div class="region">
    <label for="section" class="dislabel" type="label">Section</label>
    <input id="section" value="" disabled> 
   
</div>

<br>
<br>
<body>
    <h1>Water Quality Monitoring</h1>
</body> 

<!--ظهور اسم المستخدم الحالى-->











                    <!--Water qyality form-->
<form>
    <!--البيانات الاساسية-->
    <div class="essdata">
    <label class="dat" for="date">Date</label>
    <input id="date" type="date">

    <label class="dat"for="markz">Markz</label>
    <select id="markz" type="optgroup">
        <optgroup>
            <option value="العدوه">العدوه</option>
            <option value="مغاغة">مغاغة</option>
            <option value="بنى مزار">بنى مزار</option>
            <option value="مطاى">مطاى</option>
            <option value="سمالوط">سمالوط</option>
            <option value="المنيا">المنيا</option>
            <option value="ابوقرقاص">ابوقرقاص</option>
            <option value="ملوى">ملوى</option>
            <option value="ديرمواس">ديرمواس</option>
        </optgroup>
    </select>

    <label class="dat" for="sample">Location</label>
    <input id="sample" value="المأخذ" type="location" readonly>
    <input type="hidden" id="entry-id">


    
    </div>
    <hr>

  
       
        <input id="physical" type="radio" name="para" checked>
        <label for="physical" class="para-label" >Physical parameters</label>

        
        <input id="chemical" type="radio" name="para">
        <label for="chemical" class="para-label">Chemical parameters</label>

        <input id="biological" type="radio" name="para">
        <label for="biological" class="para-label">Biological parameters</label>
    
               <!--التحاليل الفيزيائية-->

    <div class="contents">
        <div class="content" id="physical-content">

            <label for="turbidity">Turbidity NTU</label>
            <input id="turbidity" name="turbidity" type="number">
            
            <label for="pH">pH</label>
            <input id="pH" name="pH" type="number">

            <label for="temp">Temp <sup>o</sup>C</label>
            <input id="temp" name="temp" type="number">
       
                        <!--التحاليل الكيميائية-->
        </div>
        <div class="content" id="chemical-content">

            <label for="tds">TDS mg/l</label>
            <input id="tds" name="tds" type="number">

            <label for="ch">Chlorides mg/l</label>
            <input id="ch" name="ch" type="number">

            <label for="sulf">Sulfates mg/l</label>
            <input id="sulf" name="sulf" type="number">

            <label for="fe">Fe mg/l</label>
            <input id="fe" name="fe" type="number">

            <label for="mn">Mn mg/l</label>
            <input id="mn" name="mn" type="number">

            <label for="nh3">NH<sub>3</sub> mg/l</label>
            <input id="nh3" name="nh3" type="number">

            <label for="no2">NO<sub>2</sub> mg/l</label>
            <input id="no2" name="no2" type="number">

            <label for="no3">NO<sub>3</sub> mg/l</label>
            <input id="no3" name="no3" type="number">

            <label for="do">DO mg/l</label>
            <input id="do" name="do" type="number">

            <label for="cod">COD mg/l</label>
            <input id="cod" name="cod" type="number">

            <label for="bod">BOD mg/l</label>
            <input id="bod" name="bod" type="number">

            <label for="og">Oil & Grease mg/l</label>
            <input id="og" name="og" type="number">

           
        </div>

            <!--التحاليل البيولوجية والميكروبيولوجية-->
        <div class="content" id="biological-content">
            <label for="tc">Total Coliform C.U.F/100 ml</label>
            <input id="tc" name="tc" type="number">

            <label for="ta">Total Algae Colony/100 ml</label>
            <input id="ta" name="ta" type="number">

        </div>
    </div> 
    <br>
    <br>
    

    <div class="buttons">
        <button class="button-content">Submit</button>
        
        <button class="button-content">Update</button>
        
        <button class="button-content">Delete</button>
        
    </div>
    
    <table class="table-data">
        <thead class="thead">
            <tr>
              <th>Date</th>
              <th>Markz</th>
              <th>location</th>
              <th>Turbidity</th>
              <th>pH</th>
              <th>Temp</th>
              <th>TDS</th>
              <th>Chlorides</th>
              <th>Sulfates</th>
              <th>Fe</th>
              <th>Mn</th>
              <th>NH<sub>3</sub></th>
              <th>NO<sub>2</sub></th>
              <th>NO<sub>3</sub></th>
              <th>DO</th>
              <th>COD</th>
              <th>BOD</th>
              <th>Oil&Grease</th>
              <th>Total Coliform</th>
              <th>Total Algae</th>
            </tr>
        </thead>
        <tbody>
            <tr> </tr>
        </tbody>
       
    </table>
   

</form>

</html>
<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbwm-xoojxIaAJ8-cLLIRFAthMHT1FFWS8w0gHtf6xlhU5xP3eqB47CQucqea4GDEm0Zlw/execYOUR_SCRIPT_URL_HERE"; // ضع رابط Google Script Web App هنا

// تحميل البيانات عند فتح الصفحة
window.onload = fetchData;

function fetchData() {
  fetch(scriptURL)
    .then(response => response.json())
    .then(rows => {
      const tbody = document.querySelector("table.table-data tbody");
      tbody.innerHTML = "";

      rows.slice(1).forEach((row, index) => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });

        // عند الضغط على صف، يتم تعبئة البيانات في النموذج
        tr.addEventListener("click", () => fillFormWithRow(row));
        tbody.appendChild(tr);
      });
    });
}

function fillFormWithRow(row) {
  document.getElementById("entry-id").value = row[0]; // ID
  document.getElementById("date").value = row[1];
  document.getElementById("markz").value = row[2];
  document.getElementById("sample").value = row[3];
  document.getElementById("turbidity").value = row[4];
  document.getElementById("pH").value = row[5];
  document.getElementById("temp").value = row[6];
  document.getElementById("tds").value = row[7];
  document.getElementById("ch").value = row[8];
  document.getElementById("sulf").value = row[9];
  document.getElementById("fe").value = row[10];
  document.getElementById("mn").value = row[11];
  document.getElementById("nh3").value = row[12];
  document.getElementById("no2").value = row[13];
  document.getElementById("no3").value = row[14];
  document.getElementById("do").value = row[15];
  document.getElementById("cod").value = row[16];
  document.getElementById("bod").value = row[17];
  document.getElementById("og").value = row[18];
  document.getElementById("tc").value = row[19];
  document.getElementById("ta").value = row[20];
}

// إرسال بيانات جديدة
document.querySelectorAll(".button-content")[0].addEventListener("click", function (e) {
  e.preventDefault();
  sendData("add");
});

// تحديث بيانات
document.querySelectorAll(".button-content")[1].addEventListener("click", function (e) {
  e.preventDefault();
  sendData("update");
});

// حذف بيانات
document.querySelectorAll(".button-content")[2].addEventListener("click", function (e) {
  e.preventDefault();
  sendData("delete");
});

// الدالة المشتركة للإرسال
function sendData(action) {
  const data = {
    action: action,
    id: document.getElementById("entry-id").value,
    date: document.getElementById("date").value,
    markz: document.getElementById("markz").value,
    location: document.getElementById("sample").value,
    turbidity: document.getElementById("turbidity").value,
    ph: document.getElementById("pH").value,
    temp: document.getElementById("temp").value,
    tds: document.getElementById("tds").value,
    chlorides: document.getElementById("ch").value,
    sulfates: document.getElementById("sulf").value,
    fe: document.getElementById("fe").value,
    mn: document.getElementById("mn").value,
    nh3: document.getElementById("nh3").value,
    no2: document.getElementById("no2").value,
    no3: document.getElementById("no3").value,
    do: document.getElementById("do").value,
    cod: document.getElementById("cod").value,
    bod: document.getElementById("bod").value,
    og: document.getElementById("og").value,
    tc: document.getElementById("tc").value,
    ta: document.getElementById("ta").value
  };

  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data),
    headers: {
      "Content-Type": "application/json"
    }
  }).then(response => {
    if (response.ok) {
      alert(`Data ${action}ed successfully`);
      clearForm();
      fetchData();
    } else {
      alert("Something went wrong!");
    }
  });
}

function clearForm() {
  document.querySelector("form").reset();
  document.getElementById("entry-id").value = "";
}
</script>

